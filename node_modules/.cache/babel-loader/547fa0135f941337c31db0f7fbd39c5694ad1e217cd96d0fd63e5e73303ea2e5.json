{"ast":null,"code":"var _jsxFileName = \"/Users/liosa/Desktop/NEKTAR/FRONTEND/src/pages/BuildYourNetwork.tsx\",\n  _s = $RefreshSig$();\n// src/pages/BuildYourNetwork.tsx\nimport React, { useState, useCallback } from 'react';\n// Added alpha for glassmorphism effect\nimport { Container, Typography, Button, CircularProgress, Box, Alert,\n// Add these for the Save Dialog\nDialog, DialogActions, DialogContent, DialogContentText, DialogTitle, TextField } from '@mui/material';\nimport { Splitter, Upload } from 'antd';\nimport { UploadOutlined } from '@ant-design/icons';\nimport TextEditor from '../components/TextEditor';\nimport Visualization from '../components/Visualization';\nimport pako from 'pako';\nimport theme, { appleGray } from '../theme'; // Keep theme import\n\n// Helper: file -> Base64\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst toBase64 = file => new Promise((resolve, reject) => {\n  const reader = new FileReader();\n  reader.readAsDataURL(file);\n  reader.onload = () => resolve(reader.result);\n  reader.onerror = err => reject(err);\n});\n\n// Helper: base64 -> Blob\nconst b64toBlob = (base64, type = 'application/octet-stream') => {\n  return fetch(`data:${type};base64,${base64}`).then(res => res.blob());\n};\nconst BuildYourNetwork = () => {\n  _s();\n  const [dslContent, setDslContent] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [file, setFile] = useState(null);\n  const [fileName, setFileName] = useState('');\n  const [parsedDevices, setParsedDevices] = useState([]);\n  const [parsedLinks, setParsedLinks] = useState([]);\n\n  // NEW: State to store the actual react_flow JSON object received from the backend\n  const [currentReactFlowJson, setCurrentReactFlowJson] = useState(null); // Store the raw react_flow object\n\n  // State for the Save Topology dialog\n  const [openSaveDialog, setOpenSaveDialog] = useState(false);\n  const [saveTitle, setSaveTitle] = useState('');\n\n  // AntD Upload onChange handler\n  const handleFileChange = info => {\n    setError('');\n    if (info.fileList.length > 0) {\n      const currentFile = info.fileList[info.fileList.length - 1].originFileObj;\n      if (currentFile) {\n        setFile(currentFile);\n        setFileName(currentFile.name);\n      } else {\n        setFile(null);\n        setFileName('');\n        setError('Could not read the selected file.');\n      }\n    } else {\n      setFile(null);\n      setFileName('');\n    }\n  };\n\n  // Decode & convert a PK* file\n  const handleDecodeAndConvert = useCallback(async () => {\n    if (!file) return;\n    setLoading(true);\n    setError('');\n    setParsedDevices([]); // Clear previous visualization\n    setParsedLinks([]);\n    setDslContent(''); // Clear previous DSL\n    setCurrentReactFlowJson(null); // NEW: Clear previous react_flow JSON on new decode\n\n    try {\n      const base64File = await toBase64(file);\n      const decodeResponse = await fetch('https://1nlsyfjbcb.execute-api.eu-south-1.amazonaws.com/default/pka2xml', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          file: base64File.split(',')[1],\n          action: 'decode'\n        })\n      });\n      if (!decodeResponse.ok) {\n        const errorText = await decodeResponse.text();\n        throw new Error(`Decode failed: ${decodeResponse.status} ${errorText || decodeResponse.statusText}`);\n      }\n      const responseText = await decodeResponse.text();\n      let blob;\n      try {\n        blob = await b64toBlob(responseText);\n      } catch (e) {\n        console.error(\"Failed to create blob from base64 response:\", responseText);\n        throw new Error(\"Decode service returned invalid data.\");\n      }\n      const arrayBuffer = await blob.arrayBuffer();\n      const data = pako.inflate(new Uint8Array(arrayBuffer));\n      const xmlStr = new TextDecoder('utf-8').decode(data);\n      const xmlBlob = new Blob([xmlStr], {\n        type: 'application/xml'\n      });\n      const token = localStorage.getItem(\"token\");\n      const convertResponse = await fetch('http://127.0.0.1:5000/api/decode', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      if (!convertResponse.ok) {\n        let errData;\n        try {\n          errData = await convertResponse.json();\n        } catch (e) {\n          errData = {\n            error: (await convertResponse.text()) || 'Conversion failed without specific error.'\n          };\n        }\n        throw new Error(errData.error || `Conversion failed: ${convertResponse.status}`);\n      }\n      const resultJson = await convertResponse.json();\n      if (!resultJson || !resultJson.dsl || !resultJson.react_flow) {\n        throw new Error(\"Conversion result is missing expected data (dsl or react_flow).\");\n      }\n      setDslContent(resultJson.dsl || '');\n\n      // NEW: Store the react_flow object\n      setCurrentReactFlowJson(resultJson.react_flow);\n      const nodes = resultJson.react_flow.nodes || [];\n      const edges = resultJson.react_flow.edges || [];\n      setParsedDevices(nodes.map(node => {\n        var _node$id, _node$data$label, _node$data, _node$data$src, _node$data2, _node$position$x, _node$position, _node$position$y, _node$position2, _node$data$type, _node$data3, _node$data$coordinate, _node$data4, _node$position$x2, _node$position3, _node$position$y2, _node$position4, _node$data$power_on, _node$data5, _node$data$interface, _node$data6;\n        return {\n          id: parseInt((_node$id = node === null || node === void 0 ? void 0 : node.id) !== null && _node$id !== void 0 ? _node$id : '0', 10),\n          name: (_node$data$label = node === null || node === void 0 ? void 0 : (_node$data = node.data) === null || _node$data === void 0 ? void 0 : _node$data.label) !== null && _node$data$label !== void 0 ? _node$data$label : 'Unknown',\n          src: (_node$data$src = node === null || node === void 0 ? void 0 : (_node$data2 = node.data) === null || _node$data2 === void 0 ? void 0 : _node$data2.src) !== null && _node$data$src !== void 0 ? _node$data$src : '',\n          x: (_node$position$x = node === null || node === void 0 ? void 0 : (_node$position = node.position) === null || _node$position === void 0 ? void 0 : _node$position.x) !== null && _node$position$x !== void 0 ? _node$position$x : 0,\n          y: (_node$position$y = node === null || node === void 0 ? void 0 : (_node$position2 = node.position) === null || _node$position2 === void 0 ? void 0 : _node$position2.y) !== null && _node$position$y !== void 0 ? _node$position$y : 0,\n          type: (_node$data$type = node === null || node === void 0 ? void 0 : (_node$data3 = node.data) === null || _node$data3 === void 0 ? void 0 : _node$data3.type) !== null && _node$data$type !== void 0 ? _node$data$type : 'unknown',\n          coordinates: (_node$data$coordinate = node === null || node === void 0 ? void 0 : (_node$data4 = node.data) === null || _node$data4 === void 0 ? void 0 : _node$data4.coordinates) !== null && _node$data$coordinate !== void 0 ? _node$data$coordinate : `${(_node$position$x2 = node === null || node === void 0 ? void 0 : (_node$position3 = node.position) === null || _node$position3 === void 0 ? void 0 : _node$position3.x) !== null && _node$position$x2 !== void 0 ? _node$position$x2 : 0} ${(_node$position$y2 = node === null || node === void 0 ? void 0 : (_node$position4 = node.position) === null || _node$position4 === void 0 ? void 0 : _node$position4.y) !== null && _node$position$y2 !== void 0 ? _node$position$y2 : 0}`,\n          power_on: (_node$data$power_on = node === null || node === void 0 ? void 0 : (_node$data5 = node.data) === null || _node$data5 === void 0 ? void 0 : _node$data5.power_on) !== null && _node$data$power_on !== void 0 ? _node$data$power_on : false,\n          interface: (_node$data$interface = node === null || node === void 0 ? void 0 : (_node$data6 = node.data) === null || _node$data6 === void 0 ? void 0 : _node$data6.interface) !== null && _node$data$interface !== void 0 ? _node$data$interface : {\n            name: 'N/A',\n            ip: 'N/A',\n            bandwidth: 0\n          }\n        };\n      }));\n      setParsedLinks(edges.map(edge => {\n        var _edge$source, _edge$target;\n        return {\n          from: parseInt((_edge$source = edge === null || edge === void 0 ? void 0 : edge.source) !== null && _edge$source !== void 0 ? _edge$source : '0', 10),\n          to: parseInt((_edge$target = edge === null || edge === void 0 ? void 0 : edge.target) !== null && _edge$target !== void 0 ? _edge$target : '0', 10)\n        };\n      }));\n    } catch (err) {\n      console.error('Error during decode/convert:', err);\n      setError(`Error: ${err.message || String(err)}`);\n      setParsedDevices([]);\n      setParsedLinks([]);\n      setDslContent('');\n      setCurrentReactFlowJson(null); // NEW: Clear on error\n    } finally {\n      setLoading(false);\n    }\n  }, [file]);\n\n  // Compile DSL -> Ask BE for JSON\n  const handleCompileDsl = useCallback(async () => {\n    if (!dslContent.trim()) return;\n    setLoading(true);\n    setError('');\n    setCurrentReactFlowJson(null); // NEW: Clear previous react_flow JSON on new compile\n\n    try {\n      const token = localStorage.getItem(\"token\");\n      const response = await fetch('http://127.0.0.1:5000/api/compile', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          dsl: dslContent\n        })\n      });\n      if (!response.ok) {\n        const errorMsg = await response.text();\n        throw new Error(errorMsg || `Compile failed: ${response.status}`);\n      }\n      const resultJson = await response.json();\n      if (!resultJson || !resultJson.react_flow) {\n        throw new Error(\"Compile result is missing expected data (react_flow).\");\n      }\n\n      // NEW: Store the react_flow object\n      setCurrentReactFlowJson(resultJson.react_flow);\n      const nodes = resultJson.react_flow.nodes || [];\n      const edges = resultJson.react_flow.edges || [];\n      setParsedDevices(nodes.map(node => {\n        var _node$id2, _node$data$label2, _node$data7, _node$data$src2, _node$data8, _node$position$x3, _node$position5, _node$position$y3, _node$position6, _node$data$type2, _node$data9, _node$data$coordinate2, _node$data10, _node$position$x4, _node$position7, _node$position$y4, _node$position8, _node$data$power_on2, _node$data11, _node$data$interface2, _node$data12;\n        return {\n          id: parseInt((_node$id2 = node === null || node === void 0 ? void 0 : node.id) !== null && _node$id2 !== void 0 ? _node$id2 : '0', 10),\n          name: (_node$data$label2 = node === null || node === void 0 ? void 0 : (_node$data7 = node.data) === null || _node$data7 === void 0 ? void 0 : _node$data7.label) !== null && _node$data$label2 !== void 0 ? _node$data$label2 : 'Unknown',\n          src: (_node$data$src2 = node === null || node === void 0 ? void 0 : (_node$data8 = node.data) === null || _node$data8 === void 0 ? void 0 : _node$data8.src) !== null && _node$data$src2 !== void 0 ? _node$data$src2 : '',\n          x: (_node$position$x3 = node === null || node === void 0 ? void 0 : (_node$position5 = node.position) === null || _node$position5 === void 0 ? void 0 : _node$position5.x) !== null && _node$position$x3 !== void 0 ? _node$position$x3 : 0,\n          y: (_node$position$y3 = node === null || node === void 0 ? void 0 : (_node$position6 = node.position) === null || _node$position6 === void 0 ? void 0 : _node$position6.y) !== null && _node$position$y3 !== void 0 ? _node$position$y3 : 0,\n          type: (_node$data$type2 = node === null || node === void 0 ? void 0 : (_node$data9 = node.data) === null || _node$data9 === void 0 ? void 0 : _node$data9.type) !== null && _node$data$type2 !== void 0 ? _node$data$type2 : 'unknown',\n          coordinates: (_node$data$coordinate2 = node === null || node === void 0 ? void 0 : (_node$data10 = node.data) === null || _node$data10 === void 0 ? void 0 : _node$data10.coordinates) !== null && _node$data$coordinate2 !== void 0 ? _node$data$coordinate2 : `${(_node$position$x4 = node === null || node === void 0 ? void 0 : (_node$position7 = node.position) === null || _node$position7 === void 0 ? void 0 : _node$position7.x) !== null && _node$position$x4 !== void 0 ? _node$position$x4 : 0} ${(_node$position$y4 = node === null || node === void 0 ? void 0 : (_node$position8 = node.position) === null || _node$position8 === void 0 ? void 0 : _node$position8.y) !== null && _node$position$y4 !== void 0 ? _node$position$y4 : 0}`,\n          power_on: (_node$data$power_on2 = node === null || node === void 0 ? void 0 : (_node$data11 = node.data) === null || _node$data11 === void 0 ? void 0 : _node$data11.power_on) !== null && _node$data$power_on2 !== void 0 ? _node$data$power_on2 : false,\n          interface: (_node$data$interface2 = node === null || node === void 0 ? void 0 : (_node$data12 = node.data) === null || _node$data12 === void 0 ? void 0 : _node$data12.interface) !== null && _node$data$interface2 !== void 0 ? _node$data$interface2 : {\n            name: 'N/A',\n            ip: 'N/A',\n            bandwidth: 0\n          }\n        };\n      }));\n      setParsedLinks(edges.map(edge => {\n        var _edge$source2, _edge$target2;\n        return {\n          from: parseInt((_edge$source2 = edge === null || edge === void 0 ? void 0 : edge.source) !== null && _edge$source2 !== void 0 ? _edge$source2 : '0', 10),\n          to: parseInt((_edge$target2 = edge === null || edge === void 0 ? void 0 : edge.target) !== null && _edge$target2 !== void 0 ? _edge$target2 : '0', 10)\n        };\n      }));\n    } catch (err) {\n      console.error('Error compiling DSL:', err);\n      setError(`Error: ${err.message || String(err)}`);\n      setCurrentReactFlowJson(null); // NEW: Clear on error\n    } finally {\n      setLoading(false);\n    }\n  }, [dslContent]);\n\n  // Handlers for the Save Topology dialog\n  const handleOpenSaveDialog = () => {\n    setOpenSaveDialog(true);\n    setSaveTitle(''); // Clear previous title\n  };\n  const handleCloseSaveDialog = () => {\n    setOpenSaveDialog(false);\n  };\n\n  // REVISED: Function to save the current React Flow topology to the backend\n  const handleSaveTopology = useCallback(async () => {\n    if (!saveTitle.trim()) {\n      setError('A title is required to save the topology.');\n      return;\n    }\n    // Check if there's a react_flow object to save\n    if (!currentReactFlowJson || Object.keys(currentReactFlowJson).length === 0) {\n      setError('No React Flow topology to save. Please decode a file or compile DSL first.');\n      return;\n    }\n    setLoading(true);\n    setError('');\n    try {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        throw new Error(\"Authentication token not found. Please log in.\");\n      }\n      const response = await fetch('http://127.0.0.1:5000/api/snippets', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          title: saveTitle,\n          content: JSON.stringify(currentReactFlowJson) // Use the stored react_flow JSON directly\n        })\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.msg || `Failed to save topology: ${response.status}`);\n      }\n      alert('Topology saved successfully!');\n      handleCloseSaveDialog();\n    } catch (err) {\n      console.error('Error saving topology:', err);\n      setError(`Error saving topology: ${err.message || String(err)}`);\n    } finally {\n      setLoading(false);\n    }\n  }, [saveTitle, currentReactFlowJson]); // Dependency changed to currentReactFlowJson\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: false,\n    disableGutters: true,\n    sx: {\n      height: '80vh',\n      width: '90vw',\n      display: 'flex',\n      flexDirection: 'column',\n      bgcolor: 'black',\n      borderRadius: 1\n    },\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        padding: '12px 16px',\n        bgcolor: 'black',\n        borderBottom: `1px solid ${theme.palette.divider}`,\n        display: 'flex',\n        alignItems: 'center',\n        gap: 2,\n        flexShrink: 0\n      },\n      children: [/*#__PURE__*/_jsxDEV(Upload, {\n        accept: \".pkt\",\n        beforeUpload: () => false,\n        onChange: handleFileChange,\n        showUploadList: false,\n        maxCount: 1,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"outlined\",\n          startIcon: /*#__PURE__*/_jsxDEV(UploadOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 26\n          }, this),\n          size: \"small\",\n          disabled: loading,\n          children: \"Select PKT File\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this), fileName && !loading && /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"body2\",\n        sx: {\n          color: 'text.secondary',\n          mr: 'auto'\n        },\n        children: fileName\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 351,\n        columnNumber: 13\n      }, this), !fileName && !loading && /*#__PURE__*/_jsxDEV(Box, {\n        sx: {\n          flexGrow: 1\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 36\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleDecodeAndConvert,\n        disabled: !file || loading,\n        size: \"small\",\n        sx: {\n          ml: 1\n        },\n        children: \"Decode & Convert\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 357,\n        columnNumber: 9\n      }, this), dslContent.trim().length > 0 && /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"primary\",\n        onClick: handleCompileDsl,\n        disabled: loading || !dslContent.trim(),\n        size: \"small\",\n        sx: {\n          ml: 1\n        },\n        children: \"Compile DSL\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"contained\",\n        color: \"secondary\",\n        onClick: handleOpenSaveDialog,\n        disabled: loading || !currentReactFlowJson || Object.keys(currentReactFlowJson).length === 0,\n        size: \"small\",\n        sx: {\n          ml: 1\n        },\n        children: \"Save Topology\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 20,\n        sx: {\n          ml: 2\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        px: 2,\n        pt: 1,\n        flexShrink: 0\n      },\n      children: /*#__PURE__*/_jsxDEV(Alert, {\n        severity: \"error\",\n        onClose: () => setError(''),\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        flexGrow: 1,\n        overflow: 'hidden',\n        borderTop: `1px solid ${theme.palette.divider}`,\n        position: 'relative'\n      },\n      children: /*#__PURE__*/_jsxDEV(Splitter, {\n        style: {\n          height: '100%',\n          width: '100%',\n          position: 'absolute'\n        },\n        children: [/*#__PURE__*/_jsxDEV(Splitter.Panel, {\n          defaultSize: \"40%\",\n          min: \"20%\",\n          max: \"60%\",\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              height: '100%',\n              width: '100%',\n              bgcolor: appleGray[800],\n              overflow: 'hidden',\n              borderRadius: 1\n            },\n            children: /*#__PURE__*/_jsxDEV(TextEditor, {\n              value: dslContent,\n              onChange: setDslContent\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 417,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 416,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(Splitter.Panel, {\n          children: /*#__PURE__*/_jsxDEV(Box, {\n            sx: {\n              height: '100%',\n              width: '100%',\n              bgcolor: appleGray[100],\n              overflow: 'hidden'\n            },\n            children: /*#__PURE__*/_jsxDEV(Visualization, {\n              devices: parsedDevices,\n              links: parsedLinks\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 422,\n              columnNumber: 22\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 407,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: openSaveDialog,\n      onClose: handleCloseSaveDialog,\n      children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n        children: \"Save Current Topology\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n        children: [/*#__PURE__*/_jsxDEV(DialogContentText, {\n          children: \"Please enter a title for your React Flow topology. This will help you identify it later in your cabinet.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 432,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          autoFocus: true,\n          margin: \"dense\",\n          id: \"title\",\n          label: \"Topology Title\",\n          type: \"text\",\n          fullWidth: true,\n          variant: \"standard\",\n          value: saveTitle,\n          onChange: e => setSaveTitle(e.target.value),\n          error: !!error && error.includes('title is required'),\n          helperText: error.includes('title is required') ? error : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleCloseSaveDialog,\n          children: \"Cancel\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleSaveTopology,\n          disabled: loading || !saveTitle.trim(),\n          children: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 451,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 309,\n    columnNumber: 5\n  }, this);\n};\n_s(BuildYourNetwork, \"x325elBdRl3bTB6XVuvHuhfeHck=\");\n_c = BuildYourNetwork;\nexport default BuildYourNetwork;\nvar _c;\n$RefreshReg$(_c, \"BuildYourNetwork\");","map":{"version":3,"names":["React","useState","useCallback","Container","Typography","Button","CircularProgress","Box","Alert","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","TextField","Splitter","Upload","UploadOutlined","TextEditor","Visualization","pako","theme","appleGray","jsxDEV","_jsxDEV","toBase64","file","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","err","b64toBlob","base64","type","fetch","then","res","blob","BuildYourNetwork","_s","dslContent","setDslContent","loading","setLoading","error","setError","setFile","fileName","setFileName","parsedDevices","setParsedDevices","parsedLinks","setParsedLinks","currentReactFlowJson","setCurrentReactFlowJson","openSaveDialog","setOpenSaveDialog","saveTitle","setSaveTitle","handleFileChange","info","fileList","length","currentFile","originFileObj","name","handleDecodeAndConvert","base64File","decodeResponse","method","headers","body","JSON","stringify","split","action","ok","errorText","text","Error","status","statusText","responseText","e","console","arrayBuffer","data","inflate","Uint8Array","xmlStr","TextDecoder","decode","xmlBlob","Blob","token","localStorage","getItem","convertResponse","formData","Authorization","errData","json","resultJson","dsl","react_flow","nodes","edges","map","node","_node$id","_node$data$label","_node$data","_node$data$src","_node$data2","_node$position$x","_node$position","_node$position$y","_node$position2","_node$data$type","_node$data3","_node$data$coordinate","_node$data4","_node$position$x2","_node$position3","_node$position$y2","_node$position4","_node$data$power_on","_node$data5","_node$data$interface","_node$data6","id","parseInt","label","src","x","position","y","coordinates","power_on","interface","ip","bandwidth","edge","_edge$source","_edge$target","from","source","to","target","message","String","handleCompileDsl","trim","response","errorMsg","_node$id2","_node$data$label2","_node$data7","_node$data$src2","_node$data8","_node$position$x3","_node$position5","_node$position$y3","_node$position6","_node$data$type2","_node$data9","_node$data$coordinate2","_node$data10","_node$position$x4","_node$position7","_node$position$y4","_node$position8","_node$data$power_on2","_node$data11","_node$data$interface2","_node$data12","_edge$source2","_edge$target2","handleOpenSaveDialog","handleCloseSaveDialog","handleSaveTopology","Object","keys","title","content","errorData","msg","alert","maxWidth","disableGutters","sx","height","width","display","flexDirection","bgcolor","borderRadius","children","padding","borderBottom","palette","divider","alignItems","gap","flexShrink","accept","beforeUpload","onChange","showUploadList","maxCount","variant","startIcon","_jsxFileName","lineNumber","columnNumber","size","disabled","color","mr","flexGrow","onClick","ml","px","pt","severity","onClose","overflow","borderTop","style","Panel","defaultSize","min","max","value","devices","links","open","autoFocus","margin","fullWidth","includes","helperText","_c","$RefreshReg$"],"sources":["/Users/liosa/Desktop/NEKTAR/FRONTEND/src/pages/BuildYourNetwork.tsx"],"sourcesContent":["// src/pages/BuildYourNetwork.tsx\nimport React, { useState, useCallback } from 'react';\n// Added alpha for glassmorphism effect\nimport {\n  Container,\n  Typography,\n  Button,\n  CircularProgress,\n  Box,\n  Alert,\n  alpha,\n  // Add these for the Save Dialog\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  TextField,\n} from '@mui/material';\nimport { Splitter, Upload } from 'antd';\nimport type { UploadChangeParam } from 'antd/es/upload';\nimport { UploadOutlined } from '@ant-design/icons';\nimport TextEditor from '../components/TextEditor';\nimport Visualization from '../components/Visualization';\nimport pako from 'pako';\nimport { DraggableImage, Link } from '../types';\nimport theme, { appleGray } from '../theme'; // Keep theme import\n\n// Helper: file -> Base64\nconst toBase64 = (file: File): Promise<string> =>\n  new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = () => resolve(reader.result as string);\n    reader.onerror = (err) => reject(err);\n  });\n\n// Helper: base64 -> Blob\nconst b64toBlob = (base64: string, type = 'application/octet-stream'): Promise<Blob> => {\n  return fetch(`data:${type};base64,${base64}`).then((res) => res.blob());\n};\n\nconst BuildYourNetwork: React.FC = () => {\n  const [dslContent, setDslContent] = useState<string>('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState('');\n  const [file, setFile] = useState<File | null>(null);\n  const [fileName, setFileName] = useState<string>('');\n\n  const [parsedDevices, setParsedDevices] = useState<DraggableImage[]>([]);\n  const [parsedLinks, setParsedLinks] = useState<Link[]>([]);\n\n  // NEW: State to store the actual react_flow JSON object received from the backend\n  const [currentReactFlowJson, setCurrentReactFlowJson] = useState<any>(null); // Store the raw react_flow object\n\n  // State for the Save Topology dialog\n  const [openSaveDialog, setOpenSaveDialog] = useState(false);\n  const [saveTitle, setSaveTitle] = useState('');\n\n  // AntD Upload onChange handler\n  const handleFileChange = (info: UploadChangeParam) => {\n      setError('');\n      if (info.fileList.length > 0) {\n         const currentFile = info.fileList[info.fileList.length - 1].originFileObj as File;\n         if (currentFile) {\n            setFile(currentFile);\n            setFileName(currentFile.name);\n         } else {\n             setFile(null);\n             setFileName('');\n             setError('Could not read the selected file.');\n         }\n      } else {\n         setFile(null);\n         setFileName('');\n      }\n  };\n\n    // Decode & convert a PK* file\n    const handleDecodeAndConvert = useCallback(async () => {\n        if (!file) return;\n        setLoading(true);\n        setError('');\n        setParsedDevices([]); // Clear previous visualization\n        setParsedLinks([]);\n        setDslContent(''); // Clear previous DSL\n        setCurrentReactFlowJson(null); // NEW: Clear previous react_flow JSON on new decode\n\n        try {\n            const base64File = await toBase64(file);\n            const decodeResponse = await fetch(\n                'https://1nlsyfjbcb.execute-api.eu-south-1.amazonaws.com/default/pka2xml',\n                {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify({ file: base64File.split(',')[1], action: 'decode' }),\n                }\n            );\n\n            if (!decodeResponse.ok) {\n                 const errorText = await decodeResponse.text();\n                 throw new Error(`Decode failed: ${decodeResponse.status} ${errorText || decodeResponse.statusText}`);\n            }\n\n            const responseText = await decodeResponse.text();\n\n            let blob: Blob;\n            try {\n                 blob = await b64toBlob(responseText);\n            } catch (e) {\n                console.error(\"Failed to create blob from base64 response:\", responseText);\n                throw new Error(\"Decode service returned invalid data.\");\n            }\n\n            const arrayBuffer = await blob.arrayBuffer();\n            const data = pako.inflate(new Uint8Array(arrayBuffer));\n            const xmlStr = new TextDecoder('utf-8').decode(data);\n            const xmlBlob = new Blob([xmlStr], { type: 'application/xml' });\n\n            const token = localStorage.getItem(\"token\");\n\n            const convertResponse = await fetch('http://127.0.0.1:5000/api/decode', {\n                method: 'POST',\n                body: formData,\n                headers: {\n                  Authorization: `Bearer ${token}`,\n                }\n            });\n\n            if (!convertResponse.ok) {\n                let errData;\n                try {\n                    errData = await convertResponse.json();\n                } catch (e) {\n                     errData = { error: await convertResponse.text() || 'Conversion failed without specific error.' };\n                }\n                throw new Error(errData.error || `Conversion failed: ${convertResponse.status}`);\n            }\n\n            const resultJson = await convertResponse.json();\n\n            if (!resultJson || !resultJson.dsl || !resultJson.react_flow) {\n                throw new Error(\"Conversion result is missing expected data (dsl or react_flow).\");\n            }\n\n            setDslContent(resultJson.dsl || '');\n\n            // NEW: Store the react_flow object\n            setCurrentReactFlowJson(resultJson.react_flow);\n\n            const nodes = resultJson.react_flow.nodes || [];\n            const edges = resultJson.react_flow.edges || [];\n\n            setParsedDevices(\n                nodes.map((node: any) => ({\n                    id: parseInt(node?.id ?? '0', 10),\n                    name: node?.data?.label ?? 'Unknown',\n                    src: node?.data?.src ?? '',\n                    x: node?.position?.x ?? 0,\n                    y: node?.position?.y ?? 0,\n                    type: node?.data?.type ?? 'unknown',\n                    coordinates: node?.data?.coordinates ?? `${node?.position?.x ?? 0} ${node?.position?.y ?? 0}`,\n                    power_on: node?.data?.power_on ?? false,\n                    interface: node?.data?.interface ?? { name: 'N/A', ip: 'N/A', bandwidth: 0 },\n                }))\n            );\n\n            setParsedLinks(\n                edges.map((edge: any) => ({\n                    from: parseInt(edge?.source ?? '0', 10),\n                    to: parseInt(edge?.target ?? '0', 10),\n                }))\n            );\n\n        } catch (err: any) {\n            console.error('Error during decode/convert:', err);\n            setError(`Error: ${err.message || String(err)}`);\n            setParsedDevices([]);\n            setParsedLinks([]);\n            setDslContent('');\n            setCurrentReactFlowJson(null); // NEW: Clear on error\n        } finally {\n            setLoading(false);\n        }\n    }, [file]);\n\n    // Compile DSL -> Ask BE for JSON\n    const handleCompileDsl = useCallback(async () => {\n        if (!dslContent.trim()) return;\n        setLoading(true);\n        setError('');\n        setCurrentReactFlowJson(null); // NEW: Clear previous react_flow JSON on new compile\n\n        try {\n            const token = localStorage.getItem(\"token\");\n            const response = await fetch('http://127.0.0.1:5000/api/compile', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json',\n                  Authorization: `Bearer ${token}`,\n                 },\n                body: JSON.stringify({ dsl: dslContent }),\n            });\n\n            if (!response.ok) {\n                const errorMsg = await response.text();\n                throw new Error(errorMsg || `Compile failed: ${response.status}`);\n            }\n            const resultJson = await response.json();\n\n             if (!resultJson || !resultJson.react_flow) {\n                throw new Error(\"Compile result is missing expected data (react_flow).\");\n             }\n\n            // NEW: Store the react_flow object\n            setCurrentReactFlowJson(resultJson.react_flow);\n\n            const nodes = resultJson.react_flow.nodes || [];\n            const edges = resultJson.react_flow.edges || [];\n\n            setParsedDevices(\n                nodes.map((node: any) => ({\n                    id: parseInt(node?.id ?? '0', 10),\n                    name: node?.data?.label ?? 'Unknown',\n                    src: node?.data?.src ?? '',\n                    x: node?.position?.x ?? 0,\n                    y: node?.position?.y ?? 0,\n                    type: node?.data?.type ?? 'unknown',\n                    coordinates: node?.data?.coordinates ?? `${node?.position?.x ?? 0} ${node?.position?.y ?? 0}`,\n                    power_on: node?.data?.power_on ?? false,\n                    interface: node?.data?.interface ?? { name: 'N/A', ip: 'N/A', bandwidth: 0 },\n                }))\n            );\n\n            setParsedLinks(\n                edges.map((edge: any) => ({\n                    from: parseInt(edge?.source ?? '0', 10),\n                    to: parseInt(edge?.target ?? '0', 10),\n                }))\n            );\n\n        } catch (err: any) {\n            console.error('Error compiling DSL:', err);\n            setError(`Error: ${err.message || String(err)}`);\n            setCurrentReactFlowJson(null); // NEW: Clear on error\n        } finally {\n            setLoading(false);\n        }\n    }, [dslContent]);\n\n    // Handlers for the Save Topology dialog\n    const handleOpenSaveDialog = () => {\n      setOpenSaveDialog(true);\n      setSaveTitle(''); // Clear previous title\n    };\n\n    const handleCloseSaveDialog = () => {\n      setOpenSaveDialog(false);\n    };\n\n    // REVISED: Function to save the current React Flow topology to the backend\n    const handleSaveTopology = useCallback(async () => {\n      if (!saveTitle.trim()) {\n        setError('A title is required to save the topology.');\n        return;\n      }\n      // Check if there's a react_flow object to save\n      if (!currentReactFlowJson || Object.keys(currentReactFlowJson).length === 0) {\n        setError('No React Flow topology to save. Please decode a file or compile DSL first.');\n        return;\n      }\n\n      setLoading(true);\n      setError('');\n\n      try {\n        const token = localStorage.getItem(\"token\");\n        if (!token) {\n          throw new Error(\"Authentication token not found. Please log in.\");\n        }\n\n        const response = await fetch('http://127.0.0.1:5000/api/snippets', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${token}`,\n          },\n          body: JSON.stringify({\n            title: saveTitle,\n            content: JSON.stringify(currentReactFlowJson), // Use the stored react_flow JSON directly\n          }),\n        });\n\n        if (!response.ok) {\n          const errorData = await response.json();\n          throw new Error(errorData.msg || `Failed to save topology: ${response.status}`);\n        }\n\n        alert('Topology saved successfully!');\n        handleCloseSaveDialog();\n      } catch (err: any) {\n        console.error('Error saving topology:', err);\n        setError(`Error saving topology: ${err.message || String(err)}`);\n      } finally {\n        setLoading(false);\n      }\n    }, [saveTitle, currentReactFlowJson]); // Dependency changed to currentReactFlowJson\n\n  return (\n    <Container\n      maxWidth={false}\n      disableGutters\n      sx={{\n        height: '80vh',\n        width: '90vw',\n        display: 'flex',\n        flexDirection: 'column',\n        bgcolor: 'black',\n        borderRadius: 1,\n      }}\n    >\n      {/* Header Toolbar Area */}\n      <Box\n        sx={{\n          padding: '12px 16px',\n          bgcolor: 'black',\n          borderBottom: `1px solid ${theme.palette.divider}`,\n          display: 'flex',\n          alignItems: 'center',\n          gap: 2,\n          flexShrink: 0,\n        }}\n      >\n        <Upload\n          accept=\".pkt\"\n          beforeUpload={() => false}\n          onChange={handleFileChange}\n          showUploadList={false}\n          maxCount={1}\n        >\n          <Button\n              variant=\"outlined\"\n              startIcon={<UploadOutlined />}\n              size=\"small\"\n              disabled={loading}\n           >\n             Select PKT File\n          </Button>\n        </Upload>\n\n        {fileName && !loading && (\n            <Typography variant=\"body2\" sx={{ color: 'text.secondary', mr: 'auto' }}>\n                {fileName}\n            </Typography>\n        )}\n         {!fileName && !loading && <Box sx={{ flexGrow: 1 }}/>}\n\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={handleDecodeAndConvert}\n          disabled={!file || loading}\n          size=\"small\"\n          sx={{ ml: 1 }}\n        >\n          Decode & Convert\n        </Button>\n\n        {dslContent.trim().length > 0 && (\n          <Button\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={handleCompileDsl}\n            disabled={loading || !dslContent.trim()}\n            size=\"small\"\n            sx={{ ml: 1 }}\n          >\n            Compile DSL\n          </Button>\n        )}\n\n        {/* REVISED: Save Topology Button disabled condition */}\n        <Button\n          variant=\"contained\"\n          color=\"secondary\"\n          onClick={handleOpenSaveDialog}\n          disabled={loading || !currentReactFlowJson || Object.keys(currentReactFlowJson).length === 0}\n          size=\"small\"\n          sx={{ ml: 1 }}\n        >\n          Save Topology\n        </Button>\n\n\n        {loading && <CircularProgress size={20} sx={{ ml: 2 }} />}\n      </Box>\n\n       {/* Error Alert Area */}\n       {error && (\n         <Box sx={{ px: 2, pt: 1, flexShrink: 0 }}>\n            <Alert severity=\"error\" onClose={() => setError('')}>\n            {error}\n            </Alert>\n         </Box>\n       )}\n\n      {/* Splitter takes remaining space */}\n      <Box sx={{ flexGrow: 1, overflow: 'hidden', borderTop: `1px solid ${theme.palette.divider}`, position: 'relative' }}>\n          <Splitter\n             style={{\n                 height: '100%',\n                 width: '100%',\n                 position: 'absolute',\n             }}\n          >\n             <Splitter.Panel defaultSize=\"40%\" min=\"20%\" max=\"60%\">\n                <Box sx={{ height: '100%', width: '100%', bgcolor: appleGray[800], overflow: 'hidden', borderRadius: 1 }}>\n                    <TextEditor value={dslContent} onChange={setDslContent} />\n                </Box>\n             </Splitter.Panel>\n             <Splitter.Panel>\n                <Box sx={{ height: '100%', width: '100%', bgcolor: appleGray[100], overflow: 'hidden' }}>\n                     <Visualization devices={parsedDevices} links={parsedLinks} />\n                </Box>\n             </Splitter.Panel>\n          </Splitter>\n       </Box>\n\n        {/* Material-UI Dialog for Save Topology */}\n        <Dialog open={openSaveDialog} onClose={handleCloseSaveDialog}>\n          <DialogTitle>Save Current Topology</DialogTitle>\n          <DialogContent>\n            <DialogContentText>\n              Please enter a title for your React Flow topology. This will help you identify it later in your cabinet.\n            </DialogContentText>\n            <TextField\n              autoFocus\n              margin=\"dense\"\n              id=\"title\"\n              label=\"Topology Title\"\n              type=\"text\"\n              fullWidth\n              variant=\"standard\"\n              value={saveTitle}\n              onChange={(e) => setSaveTitle(e.target.value)}\n              error={!!error && error.includes('title is required')}\n              helperText={error.includes('title is required') ? error : ''}\n            />\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handleCloseSaveDialog}>Cancel</Button>\n            <Button onClick={handleSaveTopology} disabled={loading || !saveTitle.trim()}>Save</Button>\n          </DialogActions>\n        </Dialog>\n    </Container>\n  );\n};\n\nexport default BuildYourNetwork;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}